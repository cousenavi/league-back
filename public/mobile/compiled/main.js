(function(){$(function(){var t,n,e;return e={login:function(){return'<div id="loginForm">\n<input type="text" data-value="login" placeholder=\'login\' autofocus=\'true\'><br><br>\n<input type="password" data-value="password" placeholder=\'password\'><br><br>\n<button id="loginBtn">Go!</button>\n</div>'},matches:function(t){var n;return function(){var e,a,r;for(r=[],e=0,a=t.length;a>e;e++)n=t[e],r.push("<button id='"+n._id+"'class='match'>"+n.homeTeamName+" - "+n.awayTeamName+"<br><span class='littleText'>"+n.date+" "+n.time+" "+n.placeName+"</span></button><br>");return r}().join("")},game:function(t){var n,e;return console.log(t),'<div id="homeTeam">\n  <b>'+t.homeTeam.name+"</b>\n  "+function(){var a,r;a=t.homeTeam.players,r=[];for(n in a)e=a[n],r.push("<button id='"+n+"' class='player homePlayer'>"+e[0]+" "+e[1]+"</button>");return r}().join("")+'\n  <button id="saveHomeTeamBtn">OK</button>\n</div>\n\n<div id="awayTeam" style=\'display: none\'>\n  '+function(){var a,r;a=t.awayTeam.players,r=[];for(n in a)e=a[n],r.push("<button id='"+n+"' class='player awayPlayer'>"+e[0]+" "+e[1]+"</button>");return r}().join("")+'\n  <button id="saveAwayTeamBtn">OK</button>\n</div>'},error:function(){return"error"}},t=function(t){var n;return n={},t.find("[data-value]").each(function(){return n[$(this).attr("data-value")]=$(this).val()}),t.find("[data-collection]").each(function(){var t;return t=$(this).attr("data-collection"),n[t]=[],$(this).find("[data-element]").each(function(){var e;return e={},$(this).find("[data-atom]").each(function(){return e[$(this).attr("data-atom")]=$(this).val()}),n[t].push(e)})}),n},$("#container").html(e.login()),$("#container").on("click","#loginBtn",function(){var n;return $(this).html("...").attr("disabled","true"),n=t($(this).parent()),$.ajax({url:"/login",method:"POST",data:n,success:function(t){return $("#container").html(e.matches(t))},error:function(){return $(this).html("Go!")}})}),$("#container").on("click",".match",function(){return $(this).parent().find(".match").each(function(){return $(this).attr("disabled",!0)}),$(this).html("..."),$.ajax({url:"/game?_id="+$(this).attr("id"),success:function(t){return n.setCurrentGame(t),$("#container").html(e.game(t))},error:function(){return $("#container").html(e.error())}})}),$("#container").on("click",".player",function(){return $(this).toggleClass("activePlayer"),n.setPlayerActivity($(this).attr("id"),$(this).hasClass("activePlayer"))}),$("#container").on("click","#saveHomeTeamBtn",function(){return $("#homeTeam").hide(),$("#awayTeam").show()}),$("#container").on("click","#saveAwayTeamBtn",function(){return n.sync()}),n={currentGame:void 0},n.save=function(){return console.log("здесь мы должны сохранить регистр в локал сторедж")},n.sync=function(){return console.log("здесь мы синхронизируем регстр с сервером")},n.setCurrentGame=function(t){return this.currentGame=t,this.save()},n.setPlayerActivity=function(t,n){return null!=this.currentGame.homeTeam.players[t]?this.currentGame.homeTeam.players[t][2]=n:this.currentGame.awayTeam.players[t][2]=n,this.save()}})}).call(this);